# Agent overlay: add FastAPI agent service (depends on ghostfolio)
# Launch: docker compose -f docker/docker-compose.yml -f docker/docker-compose.agent.yml up -d
services:
  agent:
    build:
      context: ../agent
      dockerfile: Dockerfile
    container_name: gf-agent
    restart: unless-stopped
    env_file:
      - ../.env
    ports:
      - 8000:8000
    depends_on:
      ghostfolio:
        condition: service_healthy
    healthcheck:
      test: ['CMD-SHELL', 'curl -f http://localhost:8000/health || exit 1']
      interval: 10s
      timeout: 5s
      retries: 5
